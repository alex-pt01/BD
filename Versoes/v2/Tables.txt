CREATE SCHEMA Projeto;
GO

CREATE TABLE Projeto.UNIVERSIDADE(
Idade	DATE	NOT NULL,
Nome_Uni VARCHAR(30) NOT NULL,
Endereco VARCHAR(30) NOT NULL,
Telefone INT NOT NULL,
EmailUni VARCHAR(40) NOT NULL,
PRIMARY KEY(EmailUni)
);


CREATE TABLE Projeto.ALUNO(
Nome VARCHAR(30) NOT NULL,
NMEC INT NOT NULL,
Email VARCHAR(40) NOT NULL,
RegimeEstudo VARCHAR(30) CHECK (RegimeEstudo='Estudante' OR RegimeEstudo='Erasmus' OR  RegimeEstudo='TrabalhadorEstudante' OR  RegimeEstudo='EstudanteInternacional'), 

ID_Dep INT NOT NULL,
ID_Horario INT NOT NULL,
ID_Biblioteca INT NOT NULL,
ID_Refeitorio INT NOT NULL,
ID_Secretaria INT NOT NULL,
ID_Curso INT NOT NULL,
EmailUni VARCHAR(40) NOT NULL,
PRIMARY KEY(NMEC)

);

CREATE TABLE Projeto.Relacao_ALUNO_BOLSADEESTUDO(
ID_BolsaEstudo INT NOT NULL,
NMEC INT NOT NULL,
PRIMARY KEY(ID_BolsaEstudo, NMEC)
);

CREATE TABLE Projeto.Relacao_ALUNO_TURMA(
ID_Turma INT NOT NULL,
NMEC INT NOT NULL,
PRIMARY KEY(ID_Turma, NMEC)
);

CREATE TABLE Projeto.Relacao_ALUNO_NUCLEO(
ID_Nucleo INT NOT NULL,
NMEC INT NOT NULL,

PRIMARY KEY(ID_Nucleo, NMEC)
);




CREATE TABLE Projeto.CURSO(
Nome_Curso VARCHAR(30) NOT NULL,
ID_Curso INT NOT NULL,


PRIMARY KEY(ID_Curso)
);

CREATE TABLE Projeto.UNIDADECURRICULAR(
ID_UC INT NOT NULL,
AnoFormacao DATE NOT NULL,

ID_Horario INT NOT NULL,
PRIMARY KEY(ID_UC)
);

/* DUVIDAS
CREATE TABLE Projeto.Relacao_UC_Avaliacao */

CREATE TABLE Projeto.Relacao_UC_CURSO(
ID_UC INT NOT NULL,
ID_Curso INT NOT NULL,

PRIMARY KEY(ID_UC, ID_Curso)
);

CREATE TABLE Projeto.Relacao_UC_PROFESSOR(
ID_UC INT NOT NULL,
TMEC INT NOT NULL,

PRIMARY KEY(ID_UC, TMEC)
);



CREATE TABLE Projeto.AVALIACAO(
ID_Curso INT NOT NULL,
notaDecimal DECIMAL(2,2) NOT NULL,
PRIMARY KEY(ID_Curso)
);

CREATE TABLE Projeto.HORARIO(
ID_Horario INT NOT NULL,
PRIMARY KEY(ID_Horario)
);

CREATE TABLE Projeto.TURMA(
ID_Turma INT NOT NULL,
AnoLectico DATE NOT NULL,
PRIMARY KEY(ID_Turma)
);

CREATE TABLE Projeto.PROFESSOR(
Nome_Prof VARCHAR(30) NOT NULL,
Num_Gabinete INT NOT NULL,
Email VARCHAR(40) NOT NULL,
TMEC INT NOT NULL,

EmailUni VARCHAR(40) NOT NULL,
PRIMARY KEY(TMEC)
);

CREATE TABLE Projeto.DEPARTAMENTO(
Nome_Dep VARCHAR(30) NOT NULL,
ID_Dep INT NOT NULL,
Localizacao_Dep VARCHAR(30) NOT NULL,

EmailUni VARCHAR(40) NOT NULL,
PRIMARY KEY(ID_Dep)
);

CREATE TABLE Projeto.SALA(
ID_Sala INT NOT NULL,
Limite_Alunos INT NOT NULL,
PRIMARY KEY(ID_Sala)
);

/*CREATE TABLE Projeto.TipoDeSALA( */

CREATE TABLE Projeto.REGISTO(
ID_Registo INT NOT NULL,

NMEC INT NOT NULL,
PRIMARY KEY(ID_Registo)
);

CREATE TABLE Projeto.NOTA(
classificacao DECIMAL(2,2) NOT NULL,
ID_Registo INT NOT NULL,
PRIMARY KEY(ID_Registo)
);

CREATE TABLE Projeto.FALTA(
Tipo_Falta VARCHAR(20) NOT NULL,
ID_Registo INT NOT NULL,
PRIMARY KEY(ID_Registo)
);

/*---------------------------------*/

CREATE TABLE Projeto.TUTOR(
ID_Tutor INT NOT NULL,
PRIMARY KEY(ID_Tutor)
);

CREATE TABLE Projeto.NUCLEO(
Nome_Nucleo VARCHAR(30) NOT NULL,
Lot_Max_Curso INT NOT NULL,
Clubes VARCHAR(30) NOT NULL,
ID_Nucleo INT NOT NULL
PRIMARY KEY(ID_Nucleo)
);

CREATE TABLE Projeto.SECRETARIA(
ID_Secretaria INT NOT NULL,
Localizacao_Secr VARCHAR(30) NOT NULL,
Lot_Max_Secr INT NOT NULL,
Pagamento_proprinas INT NOT NULL,

EmailUni VARCHAR(40) NOT NULL,
PRIMARY KEY(ID_Secretaria)
);

CREATE TABLE Projeto.REFEITORIO(
Nome_Refeitorio VARCHAR(30) NOT NULL,
ID_Refeitorio INT NOT NULL,
Lot_Max_Ref INT NOT NULL,
Nome_Menu VARCHAR(30) NOT NULL,
Senha_Refeicao INT NOT NULL,

EmailUni VARCHAR(40) NOT NULL,
PRIMARY KEY(ID_Refeitorio)
);

CREATE TABLE Projeto.BIBLIOTECA(
ID_Biblioteca INT NOT NULL,
Lot_Max_Biblio INT NOT NULL, 

EmailUni VARCHAR(40) NOT NULL,                     
PRIMARY KEY(ID_Biblioteca)
);

CREATE TABLE Projeto.BOLSA_ESTUDO_ALUNO(
ID_BolsaEstudo INT NOT NULL,
PRIMARY KEY(ID_BolsaEstudo)
);




/*Recebe como chave estrangeira a o mail da UNIVERSDIDADE */
ALTER TABLE Projeto.ALUNO ADD CONSTRAINT EmailUni FOREIGN KEY (EmailUni) REFERENCES Projeto.UNIVERSIDADE (EmailUni);
ALTER TABLE Projeto.REFEITORIO ADD CONSTRAINT EmailUni FOREIGN KEY (EmailUni) REFERENCES Projeto.UNIVERSIDADE (EmailUni);
ALTER TABLE Projeto.SECRETARIA ADD CONSTRAINT EmailUni FOREIGN KEY (EmailUni) REFERENCES Projeto.UNIVERSIDADE (EmailUni);
ALTER TABLE Projeto.BIBLIOTECA ADD CONSTRAINT EmailUni FOREIGN KEY (EmailUni) REFERENCES Projeto.UNIVERSIDADE (EmailUni);
ALTER TABLE Projeto.DEPARTAMENTO ADD CONSTRAINT EmailUni FOREIGN KEY (EmailUni) REFERENCES Projeto.UNIVERSIDADE (EmailUni);
ALTER TABLE Projeto.PROFESSOR ADD CONSTRAINT EmailUni FOREIGN KEY (EmailUni) REFERENCES Projeto.UNIVERSIDADE (EmailUni);
/*Aluno a receber estrangeiras*/
ALTER TABLE Projeto.ALUNO ADD CONSTRAINT ID_Dep FOREIGN KEY (ID_Dep) REFERENCES Projeto.DEPARTAMENTO (ID_Dep);
ALTER TABLE Projeto.ALUNO ADD CONSTRAINT ID_Horario FOREIGN KEY (ID_Horario) REFERENCES Projeto.HORARIO (ID_Horario);
ALTER TABLE Projeto.ALUNO ADD CONSTRAINT ID_Biblioteca FOREIGN KEY (ID_Biblioteca) REFERENCES Projeto.BIBLIOTECA (ID_Biblioteca);
ALTER TABLE Projeto.ALUNO ADD CONSTRAINT ID_Refeitorio FOREIGN KEY (ID_Refeitorio) REFERENCES Projeto.REFEITORIO (ID_Refeitorio);
ALTER TABLE Projeto.ALUNO ADD CONSTRAINT ID_Secretaria FOREIGN KEY (ID_Secretaria) REFERENCES Projeto.SECRETARIA (ID_Secretaria);
ALTER TABLE Projeto.ALUNO ADD CONSTRAINT ID_Curso FOREIGN KEY (ID_Curso) REFERENCES Projeto.CURSO (ID_Curso);
/*Relacao_ALUNO_BOLSADEESTUDO*/
ALTER TABLE Projeto.Relacao_ALUNO_BOLSADEESTUDO ADD CONSTRAINT ID_BolsaEstudo FOREIGN KEY (ID_BolsaEstudo) REFERENCES Projeto.BOLSA_ESTUDO_ALUNO (ID_BolsaEstudo);
ALTER TABLE Projeto.Relacao_ALUNO_BOLSADEESTUDO ADD CONSTRAINT NMEC FOREIGN KEY (NMEC) REFERENCES Projeto.ALUNO (NMEC);
/*Relacao_ALUNO_TURMA*/
ALTER TABLE Projeto.Relacao_ALUNO_TURMA ADD CONSTRAINT ID_Turma FOREIGN KEY (ID_Turma) REFERENCES Projeto.TURMA (ID_Turma);
ALTER TABLE Projeto.Relacao_ALUNO_TURMA ADD CONSTRAINT NMEC FOREIGN KEY (NMEC) REFERENCES Projeto.ALUNO (NMEC);
/*Relacao_ALUNO_NUCLEO*/
ALTER TABLE Projeto.Relacao_ALUNO_NUCLEO ADD CONSTRAINT ID_Nucleo FOREIGN KEY (ID_Nucleo) REFERENCES Projeto.NUCLEO (ID_Nucleo);
ALTER TABLE Projeto.Relacao_ALUNO_NUCLEO ADD CONSTRAINT NMEC FOREIGN KEY (NMEC) REFERENCES Projeto.ALUNO (NMEC);
/*para UC*/
ALTER TABLE Projeto.UC ADD CONSTRAINT ID_Horario FOREIGN KEY (ID_Horario) REFERENCES Projeto.HORARIO (ID_Horario);
/*Relacao_UC_CURSO*/
ALTER TABLE Projeto.Relacao_UC_CURSO ADD CONSTRAINT ID_UC FOREIGN KEY (ID_UC) REFERENCES Projeto.UC (ID_UC);
ALTER TABLE Projeto.Relacao_UC_CURSO ADD CONSTRAINT ID_Curso FOREIGN KEY (ID_Curso) REFERENCES Projeto.CURSO (ID_Curso);
/*Relacao_UC_PROFESSOR*/
ALTER TABLE Projeto.Relacao_UC_PROFESSOR ADD CONSTRAINT ID_UC FOREIGN KEY (ID_UC) REFERENCES Projeto.UC (ID_UC);
ALTER TABLE Projeto.Relacao_UC_PROFESSOR ADD CONSTRAINT TMEC FOREIGN KEY (TMEC) REFERENCES Projeto.PROFESSOR (TMEC);









































